# dhcpdLogsScan

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ª–æ–≥–æ–≤ DHCP-—Å–µ—Ä–≤–µ—Ä–∞ –∏ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –Ω–æ–≤—ã—Ö MAC-–∞–¥—Ä–µ—Å–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ —Ä–∞–Ω–µ–µ –Ω–µ –±—ã–ª–∏ –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã.

---

## üìã –û–ø–∏—Å–∞–Ω–∏–µ —Ä–∞–±–æ—Ç—ã

–°–∫—Ä–∏–ø—Ç –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏:

1. **–ß—Ç–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö MAC-–∞–¥—Ä–µ—Å–æ–≤**  
   –ò–∑–≤–ª–µ–∫–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ CSV-—Ñ–∞–π–ª–∞ (`MACs.csv`), —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ —É–∂–µ –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –∞–¥—Ä–µ—Å–æ–≤.

2. **–ê–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤ DHCP**  
   –ù–∞—Ö–æ–¥–∏—Ç –Ω–æ–≤—ã–µ MAC-–∞–¥—Ä–µ—Å–∞ –≤ —Ñ–∞–π–ª–µ –ª–æ–≥–æ–≤ (`dhcpd.log`), –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ —Å–æ–¥–µ—Ä–∂–∞—Ç—Å—è –≤ —Å–ø–∏—Å–∫–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö.

3. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö MAC-–∞–¥—Ä–µ—Å–æ–≤**  
   –ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç –Ω–æ–≤—ã–µ –∞–¥—Ä–µ—Å–∞ –≤ —Ñ–∞–π–ª `new_macs.txt` —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –≤—Ä–µ–º–µ–Ω–∏ –∏—Ö –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è.

---

## üóÇÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

- **`dhcpd.log`**  
  –õ–æ–≥-—Ñ–∞–π–ª DHCP-—Å–µ—Ä–≤–µ—Ä–∞ —Å –¥–∞–Ω–Ω—ã–º–∏ –æ –∑–∞–ø—Ä–æ—Å–∞—Ö.  

- **`MACs.csv`**  
  CSV-—Ñ–∞–π–ª —Å –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–º–∏ MAC-–∞–¥—Ä–µ—Å–∞–º–∏. –û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –∫–æ–ª–æ–Ω–∫–∞: `MACAddress`.

- **`new_macs.txt`**  
  –§–∞–π–ª –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–æ–≤—ã—Ö MAC-–∞–¥—Ä–µ—Å–æ–≤ —Å –æ—Ç–º–µ—Ç–∫–∞–º–∏ –≤—Ä–µ–º–µ–Ω–∏.

---

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞
–ü—É—Ç–∏ –∫ —Ñ–∞–π–ª–∞–º –∑–∞–¥–∞—é—Ç—Å—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏:

- **`LOG_FILE`**  
  –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É –ª–æ–≥–æ–≤ DHCP-—Å–µ—Ä–≤–µ—Ä–∞ (dhcpd.log).

- **`PROCESSED_MACS_FILE`**  
  –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö MAC-–∞–¥—Ä–µ—Å–æ–≤ (MACs.csv).

- **`NEW_MACS_FILE`**  
  –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–æ–≤—ã—Ö MAC-–∞–¥—Ä–µ—Å–æ–≤ (new_macs.txt).

---

## üõ†Ô∏è –§—É–Ω–∫—Ü–∏–∏

- **`read_processed_macs()`**  
–ß–∏—Ç–∞–µ—Ç MAC-–∞–¥—Ä–µ—Å–∞ –∏–∑ CSV-—Ñ–∞–π–ª–∞ –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏—Ö –≤ —Å–ø–∏—Å–æ–∫ processed_macs_from_file.

- **`extract_mac_addresses(log_file)`**  
–ò–∑–≤–ª–µ–∫–∞–µ—Ç –Ω–æ–≤—ã–µ MAC-–∞–¥—Ä–µ—Å–∞ –∏–∑ –ª–æ–≥–æ–≤ DHCP-—Å–µ—Ä–≤–µ—Ä–∞ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∏—Ö –≤ —Ñ–æ—Ä–º–∞—Ç–µ:
  `Time: <–≤—Ä–µ–º—è>, MAC: <–∞–¥—Ä–µ—Å>`.

- **`main()`**  
–°—á–∏—Ç—ã–≤–∞–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ MAC-–∞–¥—Ä–µ—Å–∞.
–ù–∞—Ö–æ–¥–∏—Ç –Ω–æ–≤—ã–µ MAC-–∞–¥—Ä–µ—Å–∞ –≤ –ª–æ–≥–∞—Ö.
–°–æ—Ö—Ä–∞–Ω—è–µ—Ç –Ω–æ–≤—ã–µ –∞–¥—Ä–µ—Å–∞ –≤ —Ñ–∞–π–ª –∏ –≤—ã–≤–æ–¥–∏—Ç –∏—Ö –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤ –∫–æ–Ω—Å–æ–ª—å.

---

## üìù –ü—Ä–∏–º–µ—Ä –ª–æ–≥–æ–≤
–ü—Ä–∏–º–µ—Ä —Å—Ç—Ä–æ–∫–∏ –∏–∑ —Ñ–∞–π–ª–∞ `dhcpd.log`:  
`Nov 18 15:23:47 dhcp-freebsd-pxe dhcpd[1147]: DHCPDISCOVER from 00:1a:2b:3c:4d:5e via re0`

---

## ‚ÑπÔ∏è –ü—Ä–∏–º–µ—á–∞–Ω–∏—è
- –ï—Å–ª–∏ —Ñ–∞–π–ª `MACs.csv` –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç, —Å–∫—Ä–∏–ø—Ç –Ω–∞—á–Ω—ë—Ç —Å –ø—É—Å—Ç–æ–≥–æ —Å–ø–∏—Å–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –∞–¥—Ä–µ—Å–æ–≤.
- –ï—Å–ª–∏ –Ω–æ–≤—ã—Ö MAC-–∞–¥—Ä–µ—Å–æ–≤ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ, —Ñ–∞–π–ª `new_macs.txt` –Ω–µ —Å–æ–∑–¥–∞—ë—Ç—Å—è.
- –ü—É—Ç–∏ –∫ —Ñ–∞–π–ª–∞–º –∏–º–µ–µ—Ç —Å–º—ã—Å–ª –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.
- –ü–µ—Ä–µ–¥ –∫–∞–∂–¥—ã–º –∑–∞–ø—É—Å–∫–æ–º —Å–∫—Ä–∏–ø—Ç–∞ –∑–∞–Ω–æ—Å–∏—Ç–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ MAC-–∞–¥—Ä–µ—Å–∞ –≤ `.csv` —Ñ–∞–π–ª –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ —É—á–µ—Ç–∞.

---

## üìú –õ–∏—Ü–µ–Ω–∑–∏—è
–°–∫—Ä–∏–ø—Ç –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è "–∫–∞–∫ –µ—Å—Ç—å". –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –≤–∞—à–∏–º —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º.
